diff --git a/src/compositor-fbdev.c b/src/compositor-fbdev.c
index 9c3d17e..0f1831a 100644
--- a/src/compositor-fbdev.c
+++ b/src/compositor-fbdev.c
@@ -833,6 +833,15 @@ fbdev_compositor_create(struct wl_display *display, int *argc, char *argv[],
 	                           config) < 0)
 		goto out_free;
 
+	/* Check if we run drm-backend using weston-launch */
+	compositor->base.launcher_sock =
+		weston_environment_get_fd("WESTON_LAUNCHER_SOCK");
+	if (compositor->base.launcher_sock == -1 && geteuid() != 0) {
+		weston_log("fatal: drm backend should be run "
+			   "using weston-launch binary or as root\n");
+		goto err_compositor;
+	}
+	
 	compositor->udev = udev_new();
 	if (compositor->udev == NULL) {
 		weston_log("Failed to initialize udev context.\n");
@@ -880,6 +889,9 @@ out_udev:
 out_compositor:
 	weston_compositor_shutdown(&compositor->base);
 
+err_compositor:
+	weston_compositor_shutdown(&compositor->base);	
+	
 out_free:
 	free(compositor);
 



Fixes https://bugs.freedesktop.org/show_bug.cgi?id=61930
---
 src/pixman-renderer.c | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/src/pixman-renderer.c b/src/pixman-renderer.c
index 9571f6f..9dbe9f0 100644
--- a/src/pixman-renderer.c
+++ b/src/pixman-renderer.c
@@ -485,6 +485,8 @@ pixman_renderer_init(struct weston_compositor *ec)
        if (renderer == NULL)
                return -1;
 
+       renderer->repaint_debug = 0;
+       renderer->debug_color = NULL;
        renderer->base.read_pixels = pixman_renderer_read_pixels;
        renderer->base.repaint_output = pixman_renderer_repaint_output;
        renderer->base.flush_damage = pixman_renderer_flush_damage;
-- 
1.8.1.5

Signed-off-by: Joe Konno <joe.konno at intel.com>
---
 configure.ac | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/configure.ac b/configure.ac
index f9075ae..feae582 100644
--- a/configure.ac
+++ b/configure.ac
@@ -220,10 +220,10 @@ if test x$enable_weston_launch == xyes; then
   WESTON_LAUNCH_LIBS="$WESTON_LAUNCH_LIBS -lpam"
 fi
 
-AM_CONDITIONAL(HAVE_GLU, test "x$have_glu" = "xyes" -a "$xenable_egl" = "xyes")
 if test x$enable_egl = xyes; then
   PKG_CHECK_MODULES(GLU, [glu], [have_glu=yes], [have_glu=no])
 fi
+AM_CONDITIONAL(HAVE_GLU, test "x$have_glu" = "xyes")
 
 
 AM_CONDITIONAL(HAVE_POPPLER, test "x$have_poppler" = "xyes")
-- 
1.7.11.7




diff --git a/src/weston-launch.c b/src/weston-launch.c
index 36f9c6b..7238128 100644
--- a/src/weston-launch.c
+++ b/src/weston-launch.c
@@ -109,7 +109,7 @@ weston_launch_allowed(struct weston_launch *wl)
 	if (getuid() == 0)
 		return 1;
 
-	gr = getgrnam("weston-launch");
+	gr = getgrnam("plugdev");
 	if (gr) {
 		groups = read_groups();
 		if (groups) {
@@ -550,7 +550,7 @@ main(int argc, char *argv[])
 #else
 		      " - enable systemd session support for weston-launch.\n"
 #endif
-		      " - or add yourself to the 'weston-launch' group.");
+		      " - or add yourself to the 'plugdev' group.");
 
 	if (setup_tty(&wl, tty) < 0)
 		return 1;
