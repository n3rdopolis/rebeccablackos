diff --git a/CMakeLists.txt b/CMakeLists.txt
index 5335bd5..e1ff8e7 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -44,6 +44,7 @@ endif()
 if(X11_FOUND)
     find_package(XCB COMPONENTS XCB SYNC)
     find_package(X11_XCB)
+    set(HAVE_X11 TRUE)
     if (X11_XSync_FOUND AND XCB_XCB_FOUND AND X11_XCB_FOUND AND XCB_SYNC_FOUND)
         # One cannot just use "set(HAVE_XSYNC X11_XSync_FOUND AND XCB_XCB_FOUND...)"
         # Doing so would create a list because the value passed to set() is not evaluated.
@@ -63,6 +64,8 @@ if(X11_FOUND)
     if(NOT HAVE_XSCREENSAVER AND NOT HAVE_XSYNC)
         message(FATAL_ERROR "\nNeither the XSync (libXext) nor XScreensaver (libXss) development package was found.\nPlease install one of them (XSync is recommended)")
     endif()
+else()
+    set(HAVE_X11 FALSE)
 endif()
 
 # Subdirectories
diff --git a/src/config-kidletime.h.cmake b/src/config-kidletime.h.cmake
index d3f0cfd..4a1fafe 100644
--- a/src/config-kidletime.h.cmake
+++ b/src/config-kidletime.h.cmake
@@ -1,6 +1,10 @@
 /* config-kidletime.h. Generated by cmake from config-kidletime.h.cmake */
 
+/* Define if you have the XScreensaver extension */
 #cmakedefine01 HAVE_XSCREENSAVER
 
 /* Define if you have the XSync extension */
 #cmakedefine01 HAVE_XSYNC
+
+/* Define if you have X11 */
+#cmakedefine01 HAVE_X11
diff --git a/src/kidletime.cpp b/src/kidletime.cpp
index f38ae46..f7070c6 100644
--- a/src/kidletime.cpp
+++ b/src/kidletime.cpp
@@ -40,6 +40,9 @@
 
 #include <QPointer>
 #include <QSet>
+#if HAVE_X11
+#include <QX11Info>
+#endif
 
 class KIdleTimeHelper
 {
@@ -187,17 +190,21 @@ void KIdleTimePrivate::loadSystem()
 
 #if HAVE_XSYNC
 #if HAVE_XSCREENSAVER
-    if (XSyncBasedPoller::instance()->isAvailable()) {
-        poller = XSyncBasedPoller::instance();
-    } else {
-        poller = new XScreensaverBasedPoller();
+    if (QX11Info::isPlatformX11()) {
+      if (XSyncBasedPoller::instance()->isAvailable()) {
+	  poller = XSyncBasedPoller::instance();
+      }
     }
 #else
-    poller = XSyncBasedPoller::instance();
+    if (QX11Info::isPlatformX11()) {
+      poller = XSyncBasedPoller::instance();
+    }
 #endif
 #else
 #if HAVE_XSCREENSAVER
-    poller = new XScreensaverBasedPoller();
+    if (QX11Info::isPlatformX11()) {
+      poller = new XScreensaverBasedPoller();
+    }
 #endif
 #endif
 
@@ -209,10 +216,10 @@ void KIdleTimePrivate::loadSystem()
     poller = new WindowsPoller();
 #endif
 
-    if (!poller->isAvailable()) {
-        poller = 0;
-    }
     if (!poller.isNull()) {
+	if (!poller->isAvailable()) {
+	  poller = 0;
+	}
         poller.data()->setUpPoller();
     }
 }
@@ -222,11 +229,13 @@ void KIdleTimePrivate::unloadCurrentSystem()
     if (!poller.isNull()) {
         poller.data()->unloadPoller();
 #if HAVE_XSYNC
-        if (qobject_cast<XSyncBasedPoller *>(poller.data()) == 0) {
+	 if (QX11Info::isPlatformX11()) {
+	  if (qobject_cast<XSyncBasedPoller *>(poller.data()) == 0) {
 #endif
             poller.data()->deleteLater();
 #if HAVE_XSYNC
-        }
+	    }
+	 }
 #endif
     }
 }
