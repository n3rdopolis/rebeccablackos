diff --git a/libkwineffects/kwinglplatform.cpp b/libkwineffects/kwinglplatform.cpp
index 6a60e5e..6dee53b 100644
--- a/libkwineffects/kwinglplatform.cpp
+++ b/libkwineffects/kwinglplatform.cpp
@@ -24,6 +24,7 @@ along with this program.  If not, see <http://www.gnu.org/licenses/>.
 #include <QRegExp>
 #include <QStringList>
 #include <QDebug>
+#include <QX11Info>
 
 #include <sys/utsname.h>
 #include <X11/Xlib.h>
@@ -63,7 +64,7 @@ static qint64 getXServerVersion()
     qint64 major, minor, patch;
 
     Display *dpy = display();
-    if (dpy && strstr(ServerVendor(dpy), "X.Org")) {
+    if (QX11Info::isPlatformX11() && dpy && strstr(ServerVendor(dpy), "X.Org")) {
         const int release  = VendorRelease(dpy);
         major = (release / 10000000);
         minor = (release /   100000) % 100;
